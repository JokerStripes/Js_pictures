<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>PK Half-life Lists — Parent & Metabolite until 1 µg</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body { font-family: Arial, Helvetica, sans-serif; margin:18px; background:#f8fbff; color:#111; }
    .card { background:#fff; padding:14px; border-radius:8px; box-shadow:0 2px 10px rgba(20,40,80,0.06); margin-bottom:14px; }
    label { display:block; margin-bottom:6px; font-weight:600; }
    input[type="number"] { padding:8px; width:120px; border-radius:6px; border:1px solid #dfeeff; }
    button { padding:8px 12px; margin-left:8px; background:#2b7cff; color:white; border:none; border-radius:6px; cursor:pointer; }
    table { width:100%; border-collapse:collapse; margin-top:10px; }
    th, td { padding:8px 6px; border:1px solid #e7eefc; text-align:right; font-size:0.95rem; }
    th { background:#f0f6ff; font-weight:700; }
    .small { font-size:0.9rem; color:#555; text-align:left; }
  </style>
</head>
<body>
  <h2>PK Half-life Lists — Until Both < 1 µg</h2>

  <div class="card">
    <strong>Instructions:</strong>
    <p class="small">Enter dose in grams. The table shows values at each parent half-life (1.5 h) until both the parent drug and the metabolite are below 1 µg. Model is fixed: parent t½ = 1.5 h, metabolite fraction = 0.40, metabolite t½ = 12 h, distribution volume = 5 L.</p>
  </div>

  <div class="card">
    <label for="dose">Amount taken (g)</label>
    <input id="dose" type="number" min="0" step="0.01" value="1.00">
    <button id="go">Generate list</button>
  </div>

  <div class="card" id="outputArea"></div>

<script>
(function(){
  // Fixed parameters
  const t12_parent = 1.5; // h
  const t12_met = 12.0;   // h
  const frac = 0.40;
  const vol_L = 5.0;

  const kp = Math.log(2) / t12_parent;
  const km = Math.log(2) / t12_met;

  function parentMass(A0, t){
    return A0 * Math.exp(-kp*t);
  }

  function metMass(A0, t){
    if (Math.abs(km-kp) > 1e-12){
      return frac*A0*(kp/(km-kp))*(Math.exp(-kp*t) - Math.exp(-km*t));
    } else {
      return frac*A0*kp*t*Math.exp(-kp*t);
    }
  }

  function fmt(n){
    if (n<1e-2 && n>0) return n.toExponential(3);
    if (n>=1e3) return n.toFixed(0);
    return n.toFixed(2);
  }

  function generate(){
    const dose_g = parseFloat(document.getElementById('dose').value)||0;
    const A0 = dose_g*1e6; // µg
    let rows=[];
    let n=0;
    while(true){
      n++;
      const t=n*t12_parent;
      const p=parentMass(A0,t);
      const m=metMass(A0,t);
      rows.push({
        time:t, 
        parent:p, parentC:p/vol_L,
        met:m, metC:m/vol_L
      });
      // stop when both <1 µg
      if (p<1 && m<1) break;
      if (n>500) break; // safety cap
    }

    let html='<div class="small">Dose: '+dose_g+' g ('+A0.toFixed(0)+' µg). Stops when both parent and metabolite <1 µg.</div>';
    html+='<table><thead><tr><th style="text-align:left">Time (h)</th><th>Parent mass (µg)</th><th>Parent conc (µg/L)</th><th>Metab mass (µg)</th><th>Metab conc (µg/L)</th></tr></thead><tbody>';
    for (const r of rows){
      html+='<tr><td style="text-align:left">'+r.time.toFixed(2)+'</td><td>'+fmt(r.parent)+'</td><td>'+fmt(r.parentC)+'</td><td>'+fmt(r.met)+'</td><td>'+fmt(r.metC)+'</td></tr>';
    }
    html+='</tbody></table>';
    document.getElementById('outputArea').innerHTML=html;
  }

  document.getElementById('go').addEventListener('click',generate);
  generate();
})();
</script>
</body>
</html>