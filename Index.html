<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>AI Text‚ÜíImage Demo</title>
  <style>
    body {
      font-family: sans-serif;
      max-width: 600px;
      margin: 2rem auto;
      padding: 0 1rem;
    }
    input, button {
      font-size: 1rem;
      padding: 0.5rem;
      margin-right: 0.5rem;
    }
    #preview img {
      max-width: 100%;
      margin-top: 1rem;
      border: 1px solid #ddd;
      border-radius: 4px;
    }
    #status {
      margin-top: 1rem;
      font-style: italic;
    }
  </style>
</head>
<body>
  <h1>üñºÔ∏è AI Text ‚Üí Image</h1>
  <p>Enter any text prompt and click ‚ÄúGenerate‚Äù to see a Stable Diffusion‚Äìpowered image.</p>
  
  <div>
    <input type="text" id="prompt" placeholder="e.g. a futuristic cityscape at dusk" size="40">
    <button id="go">Generate</button>
  </div>
  <div id="status"></div>
  <div id="preview"></div>

  <script>
    document.getElementById('go').onclick = async () => {
      const promptInput = document.getElementById('prompt');
      const status = document.getElementById('status');
      const preview = document.getElementById('preview');
      const prompt = promptInput.value.trim();
      
      preview.innerHTML = '';
      status.textContent = '';

      if (!prompt) {
        status.textContent = 'Please enter a prompt.';
        return;
      }

      status.textContent = 'Generating‚Ä¶ (this can take 10‚Äì30 s)';
      
      const ENDPOINT = 'https://stablehorde.net/api/latest/generate/sync';
      const PROXY    = 'https://test.cors.workers.dev/?';

      try {
        const res = await fetch(PROXY + encodeURIComponent(ENDPOINT), {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            prompt: prompt,
            params: {
              n:      1,
              width:  512,
              height: 512,
              steps:  30,
              scale:  7
            },
            api_key: '0000000000'
          })
        });

        if (!res.ok) {
          status.textContent = `Error: ${res.status} ${res.statusText}`;
          return;
        }

        const json = await res.json();
        if (json.error) {
          status.textContent = 'Error: ' + json.error;
        } else if (json.images && json.images.length) {
          const img = document.createElement('img');
          img.src = 'data:image/png;base64,' + json.images[0];
          preview.appendChild(img);
          status.textContent = '';
        } else {
          status.textContent = 'No image returned.';
        }
      } catch (e) {
        status.textContent = 'Network error: ' + e.message;
      }
    };
  </script>
</body>
</html>
